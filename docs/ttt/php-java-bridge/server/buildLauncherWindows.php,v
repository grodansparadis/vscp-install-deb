head	1.5;
access;
symbols
	Release-7-1-1:1.5.0.2
	Root_Release-7-1-1:1.5
	Root_Release_7-0-1:1.1
	Release_7-0-1:1.1.0.22
	Release_7-0-0:1.1.0.20
	Root_Release_7-0-0:1.1
	Release-6-2-2:1.1.0.18
	Release-6-1-2-3:1.1
	Root_Release-6-1-2-3:1.1
	Release-6-1-2-2:1.1.0.16
	Root_Release-6-1-2-2:1.1
	debian_version_6_1_2_1-1:1.1
	upstream_version_6_1_2_1:1.1
	Release-6-1-2-1_new:1.1.0.14
	Root_Release-6-1-2-1_new:1.1
	Release-6-1-2-1:1.1.0.12
	Root_Release-6-1-2-1:1.1
	upstream_version_6_1_2:1.1
	debian_version_6_1_2-1:1.1
	Release-6-1-2:1.1.0.10
	Root_Release-6-1-2:1.1
	debian_version_6_1_1-2:1.1
	debian_version_6_1_1-1:1.1
	upstream_version_6_1_1:1.1
	Release-6-1-1:1.1.0.8
	Root_Release-6-1-1:1.1
	Release-6-0-4:1.1.0.6
	Root_Release-6-0-4:1.1
	Release-6-0-3_NEW:1.1.0.2
	Root_Release-6-0-3_NEW:1.1
	Root_Release-6-0-0:1.1
	Release-6-0-3:1.1.0.4
	Root_Release-6-0-3:1.1;
locks; strict;
comment	@# @;


1.5
date	2017.04.02.17.09.49;	author jost_boekemeier;	state Exp;
branches;
next	1.4;

1.4
date	2017.03.26.21.30.43;	author jost_boekemeier;	state dead;
branches;
next	1.3;

1.3
date	2017.03.19.15.33.13;	author jost_boekemeier;	state Exp;
branches;
next	1.2;

1.2
date	2017.03.11.14.55.05;	author jost_boekemeier;	state Exp;
branches;
next	1.1;

1.1
date	2010.02.28.15.20.43;	author jost_boekemeier;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Revert: On windows PHP_FCGI_CHILDREN=5 php-cgi -b 9876 manages its children using AssignProcessToJobObject. However, when php-cgi is started from Java, the job object is that of the Java process. To fix this CreateProcess has a new flag CREATE_BREAKAWAY_FROM_JOB (since Vista). Unfortunately we cannot set this flag from Java  (using ProcessBuilder), so we have to use our own wrapper. Instead of using a wrapper like php-fpm (for which we would have to supply our own windows 32/64 bit binary anyway), we decided to use our existing wrapper "launcher.exe".
@
text
@<?php
 
function createOutfile($name) {
  $file = fopen("php/java/bridge/generated/${name}.java", "wb") or die("fopen");
  $str =<<<HEAD_OUTFILE
package php.java.bridge.generated;
public class ${name} {
  public static final byte[] bytes = new byte[]{

HEAD_OUTFILE;
  fwrite($file, $str);
  return $file;
}
function finishOutfile($file) {
  $str =<<<TAIL_OUTFILE
  };
}

TAIL_OUTFILE;
  fwrite($file, $str);
  fclose($file) or die("fclose");
}

define ("FILE_LENGTH", 8192);
$names = array("LauncherWindows", "LauncherWindows2",
	       "LauncherWindows3","LauncherWindows4",
	       "LauncherWindows5","LauncherWindows6",
	       "LauncherWindows7","LauncherWindows8");
$counter = 0;
$linectr = 1;

$file = fopen($argv[1], "rb") or die("fopen");
for ($byte=fread($file,1); !feof($file); $byte=fread($file, 1)) {
  if ($counter%FILE_LENGTH==0) {
    if(isset($outfile)) finishOutfile($outfile);
    $outfile = createOutfile($names[(int)($counter/FILE_LENGTH)]);
    $linectr = 1;
  }
  fprintf($outfile, "(byte)0%o,%s", ord($byte), $linectr%16?" ":"\n");

  $linectr++;
  $counter++;
}
finishOutfile($outfile);
fclose($file) or die("fclose");
?>@


1.4
log
@New fastcgi implementation
@
text
@@


1.3
log
@New FastCGI implementation
@
text
@@


1.2
log
@Renamed PHP_FCGI_CHILDREN to PHP_JAVA_BRIDGE_FCGI_CHILDREN to avoid PHP7 spawning PHP_FCGI_CHILDREN  childs by itself
@
text
@d4 1
a4 1
  $file = fopen("php/java/bridge/${name}.java", "wb") or die("fopen");
d6 1
a6 1
package php.java.bridge;
@


1.1
log
@Release-6-0-3
@
text
@d26 3
a28 1
	       "LauncherWindows3","LauncherWindows4");
@

