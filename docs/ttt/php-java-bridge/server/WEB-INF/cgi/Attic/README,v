head	1.12;
access;
symbols
	Root_Release_7-0-1:1.8
	Release_7-0-1:1.8.0.6
	Release_7-0-0:1.8.0.4
	Root_Release_7-0-0:1.8
	Release-6-2-2:1.8.0.2
	Release-6-1-2-3:1.7
	Root_Release-6-1-2-3:1.7
	Release-6-1-2-2:1.7.0.44
	Root_Release-6-1-2-2:1.7
	debian_version_6_1_2_1-1:1.7
	upstream_version_6_1_2_1:1.7
	Release-6-1-2-1_new:1.7.0.42
	Root_Release-6-1-2-1_new:1.7
	Release-6-1-2-1:1.7.0.40
	Root_Release-6-1-2-1:1.7
	upstream_version_6_1_2:1.7
	debian_version_6_1_2-1:1.7
	Release-6-1-2:1.7.0.38
	Root_Release-6-1-2:1.7
	debian_version_6_1_1-2:1.7
	debian_version_6_1_1-1:1.7
	upstream_version_6_1_1:1.7
	Release-6-1-1:1.7.0.36
	Root_Release-6-1-1:1.7
	Release-6-0-4:1.7.0.34
	Root_Release-6-0-4:1.7
	Release-6-0-3_NEW:1.7.0.30
	Root_Release-6-0-3_NEW:1.7
	Release-6-0-3:1.7.0.32
	Root_Release-6-0-3:1.7
	Release-6-0-0:1.7.0.28
	Root_Release-6-0-0:1.7
	Release-5-5-4-1:1.7.0.26
	Root_Release-5-5-4-1:1.7
	Release-5-5-4:1.7.0.24
	Root_Release-5-5-4:1.7
	Release-5-5-3:1.7.0.22
	ROOT_Release-5-5-3:1.7
	Release-5-5-2:1.7.0.20
	Root_Release-5-5-2:1.7
	debian_version_5_5_1-1:1.7
	Release-5-5-1:1.7.0.16
	upstream_version_5_5_1:1.7
	ROOT_Release-5-5-1:1.7
	debian_version_5_5-1:1.7
	upstream_version_5_5:1.7
	ROOT_Release-5-5:1.7
	Release-5-5:1.7.0.18
	debian_version_5_4_4_2-3:1.7
	Release-5-4-4-2-1:1.7.0.12
	debian_version_5_4_4_2-2:1.7
	debian_version_5_4_4_2-1:1.7
	upstream_version_5_4_4_2:1.7
	debian_version_5_4_4_1-1:1.7
	upstream_version_5_4_4_1:1.7
	debian_version_5_4_4-1:1.7
	upstream_version_5_4_4:1.7
	Release-5-4-4:1.7.0.14
	Root_Release-5-4-4:1.7
	debian_version_5_4_3_2-1:1.7
	upstream_version_5_4_3_2:1.7
	Release_5-4-3-2:1.7.0.10
	Root_Release_5-4-3-2:1.7
	upstream_version_5_4_3_1:1.7
	debian_version_5_4_3_1-1:1.7
	Release-5-4-3:1.7.0.8
	Root_Release-5-4-3:1.7
	Root_Release-5-4-1:1.7
	Release-5-4-1:1.7.0.6
	Root_Release-5-4:1.7
	Release-5-4:1.7.0.4
	upstream_version_5_3_4:1.7
	debian_version_5_3_4-1:1.7
	ROOT_Release-5-3-4:1.7
	Release-5-3-4:1.7.0.2
	ROOT_Release-5-3-3:1.6
	Release-5-3-3:1.6.0.42
	debian_version_5_3_2_1_2-1:1.6
	upstream_version_5_3_2_1_2:1.6
	debian_version_5_3_2_1_1-1:1.6
	debian_version_5_3_2_1_1:1.6
	upstream_version_5_3_2_1_1:1.6
	Root_Release-5-3-2-1:1.6
	Release-5-3-2-1:1.6
	ROOT_RELEASE-5-3-2-1:1.6
	RELEASE-5-3-2-1:1.6.0.44
	Release-5-3-2:1.6.0.40
	Root_Release-5-3-2:1.6
	Root_Release-5-3-1:1.6
	Release-5-3-1:1.6.0.38
	Release-5-2-3-1:1.6.0.36
	Root_Release-5-2-3-1:1.6
	Release-5-2-2-4:1.6.0.34
	Root_Release-5-2-2-4:1.6
	Release-5-2-2-1:1.6.0.32
	Root_Release-5-2-2-1:1.6
	upstream_version_5_2_2:1.6
	debian_version_5_2_2-1:1.6
	Release-5-2-2:1.6.0.30
	ROOT_Release-5-2-2:1.6
	ROOT_Release-5-2-1:1.6
	Release-5-2-1:1.6.0.28
	Release-5-2-0:1.6.0.26
	ROOT_Release-5-2-0:1.6
	ROOT_Release-5-1-2:1.6
	Release-5-1-2:1.6.0.24
	Version-5-1-1:1.6.0.22
	ROOT_Version-5-1-1:1.6
	debian_version_5_1_0-1:1.6
	upstream_version_5_1_0:1.6
	ROOT_Release-5-1-0:1.6
	Release-5-1-0:1.6.0.20
	ROOT_Release-5-0-0:1.6
	Release-5-0-0:1.6.0.18
	Release-4-3-3:1.6.0.16
	ROOT_Release-4-3-3:1.6
	upstream_version_4_3_2:1.6
	debian_version_4_3_2-1:1.6
	ROOT_Release-4-3-2:1.6
	Release-4-3-2:1.6.0.14
	Release-4-3-1:1.6.0.12
	ROOT_Release-4-3-1:1.6
	debian_version_4_3_0-1:1.6
	upstream_version_4_3_0:1.6
	ROOT_Release-4-3-0:1.6
	Release-4-3-0:1.6.0.10
	debian_version_3_2_1b-2:1.4
	debian_version_4_2_2-1:1.6
	upstream_version_4_2_2:1.6
	debian_version_3_2_1b-1:1.4
	upstream_version_3_2_1b:1.4
	Release-4-1-2:1.6.0.8
	Release-4-0-8:1.6.0.6
	debian_version_4_0_8a-1:1.6
	upstream_version_4_0_8a:1.6
	jostb-debian-ubuntu-patch:1.6.0.4
	debian_version_4_0_8-1:1.6
	upstream_version_4_0_8:1.6
	debian_version_4_0_7-1:1.6
	upstream_version_4_0_7:1.6
	debian_version_4_0_6-1:1.6
	upstream_version_4_0_6:1.6
	debian_version_4_0_2-1:1.6
	upstream_version_4_0_2:1.6
	Release-4-0-2_Root:1.6
	Release-4-0-2:1.6.0.2
	upstream_version_4_0_1:1.5
	debian_version_4_0_1-2:1.5
	Release-3-2-1:1.4.0.4
	Release-3-1-8:1.4.0.2
	Release-3-0-8_root:1.1
	Release-3-0-8_Root:1.1
	Release-3-0-8:1.1.0.2;
locks; strict;
comment	@# @;


1.12
date	2017.04.09.14.35.24;	author jost_boekemeier;	state dead;
branches;
next	1.11;

1.11
date	2017.04.02.17.09.49;	author jost_boekemeier;	state Exp;
branches;
next	1.10;

1.10
date	2017.03.26.21.30.43;	author jost_boekemeier;	state Exp;
branches;
next	1.9;

1.9
date	2017.03.11.13.37.51;	author jost_boekemeier;	state Exp;
branches;
next	1.8;

1.8
date	2010.05.31.19.31.10;	author jost_boekemeier;	state Exp;
branches;
next	1.7;

1.7
date	2008.11.15.14.27.51;	author jost_boekemeier;	state Exp;
branches;
next	1.6;

1.6
date	2007.03.19.13.03.18;	author jost_boekemeier;	state Exp;
branches
	1.6.42.1;
next	1.5;

1.5
date	2007.03.09.20.28.12;	author andremachado;	state Exp;
branches;
next	1.4;

1.4
date	2006.08.08.17.20.46;	author jost2345;	state Exp;
branches;
next	1.3;

1.3
date	2006.06.19.20.37.21;	author jost2345;	state Exp;
branches;
next	1.2;

1.2
date	2006.05.15.19.03.29;	author jost2345;	state Exp;
branches;
next	1.1;

1.1
date	2005.12.08.18.47.27;	author jost2345;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2006.05.15.19.02.13;	author jost2345;	state Exp;
branches;
next	;

1.6.42.1
date	2008.11.13.21.31.51;	author jost_boekemeier;	state Exp;
branches;
next	;


desc
@@


1.12
log
@*** empty log message ***
@
text
@If this directory contains a PHP FastCGI executable called
<architecture>-<os>/php-cgi.sh] or <architecture>-<os>/php-cgi.exe,
the PHP/Java Bridge library tries to call it via a /bin/sh wrapper 
(see launcher.sh) or via a "launcher.exe" when the server 
or the web context starts:


   internet 
  clients 
        \                    
         \ jsp/servlet/php req.                     .
           \                                        .
            ---- :8080 -- J2EE AS                   .
           /                 |                      .
          |                  |                      .
          |                  ---- servlet         /------ :9667
          |                  ---- FastCGIServlet /  .   PHP FastCGI Server
          |                  ---- jsp               .        |
          |                  ->-- PhpJavaServlet    .        \--- php
          |                  ---- ...            \ ------->--\--- php -->|
          |                                         .  P-J-B      ...    |
          |                                         .  PROTOCOL          |
          ------------------------------<--------------------------------|
                                   P-J-B PROTOCOL   .




UNIX: If /bin/sh is available and the php-cgi supports the -b flag,
the library executes the following command during startup:

REDIRECT_STATUS="200" \
X_JAVABRIDGE_OVERRIDE_HOSTS="/" \
PHP_JAVA_BRIDGE_FCGI_CHILDREN="5" \
PHP_FCGI_MAX_REQUESTS="5000" \
arch-os/launcher.sh arch-os/php-cgi -c php-cgi.ini -b 127.0.0.1:9667


WINDOWS: If /bin/sh is not available or if the php-cgi.exe does not
support the -b flag, the library executes the following command during
startup:

set REDIRECT_STATUS "200"
set X_JAVABRIDGE_OVERRIDE_HOSTS "/"
set PHP_JAVA_BRIDGE_FCGI_CHILDREN "5" 
set PHP_FCGI_MAX_REQUESTS "5000"
launcher.exe PHP-CGI NAMED-PIPE PHP-OPTIONS

@


1.11
log
@Revert: On windows PHP_FCGI_CHILDREN=5 php-cgi -b 9876 manages its children using AssignProcessToJobObject. However, when php-cgi is started from Java, the job object is that of the Java process. To fix this CreateProcess has a new flag CREATE_BREAKAWAY_FROM_JOB (since Vista). Unfortunately we cannot set this flag from Java  (using ProcessBuilder), so we have to use our own wrapper. Instead of using a wrapper like php-fpm (for which we would have to supply our own windows 32/64 bit binary anyway), we decided to use our existing wrapper "launcher.exe".
@
text
@@


1.10
log
@New fastcgi implementation
@
text
@d34 1
a34 1
PHP_FCGI_CHILDREN="5" \
d45 1
a45 1
set PHP_FCGI_CHILDREN "5" 
@


1.9
log
@Renamed PHP_FCGI_CHILDREN to PHP_JAVA_BRIDGE_FCGI_CHILDREN to avoid PHP7 spawning PHP_FCGI_CHILDREN  childs by itself
@
text
@d34 1
a34 1
PHP_JAVA_BRIDGE_FCGI_CHILDREN="5" \
d45 1
a45 1
set PHP_JAVA_BRIDGE_FCGI_CHILDREN "5" 
@


1.8
log
@x64 support
@
text
@d34 1
a34 1
PHP_FCGI_CHILDREN="5" \
d45 1
a45 1
set PHP_FCGI_CHILDREN "5" 
@


1.7
log
@Release 5.3.3
@
text
@d2 4
a5 3
php-cgi-<architecture>-<os>[.exe|.sh], the PHP/Java Bridge library
tries to call it via a /bin/sh wrapper (see launcher.sh) or via a
"launcher.exe" when the server or the web context starts:
d36 1
a36 1
launcher.sh php-cgi-arch-os -c php-cgi-arch-os.ini -b 127.0.0.1:9667
a48 33

----------------------------------------------------------------------
Installation:

On Unix compile a FastCGI PHP binary and copy it into this directory
and rename it to php-cgi-arch-os. Create a /bin/sh wrapper called
php-cgi-arch-os.sh and create a PHP .ini file, see the
php-cgi-i386-linux.sh and php-cgi-i386-linux.ini for a template.

Example for i386 linux:

  php-cgi-i386-linux.sh  # starts the ./php-cgi-i386-linux binary
  php-cgi-i386-linux     # loads php-cgi-i386-linux.ini
  php-cgi-i386-linux.ini # custom PHP ini file
  

On Windows copy the php-cgi.exe and the php5ts.dll into this
directory. Create a PHP .ini file called php-cgi.ini.

Example for php4, x86 windows:

  php-cgi-x86-windows.exe # php-cgi.exe, loads php.ini
  php4ts.dll              # required by the .exe
  php.ini                 # custom PHP ini file


Start the web context, browse to http://localhost/webContext/test.php
and check if the application server has started 5 php-cgi-arch-os
executables.

If the FastCGI SAPI fails, the bridge writes a message to the log, the
FastCGIServlet is switched off and the PhpCGIServlet takes over.

@


1.6
log
@Release-4-0-2
@
text
@d61 1
a61 2
  php-cgi-i386-linux.ini # loads java-i386-linux.so
  java-i386-linux.so     # the optimized PHP/Java Bridge extension
d71 1
a71 2
  php.ini                 # loads java-x86-windows.dll
  java-x86-windows.dll    # the optimized PHP/Java Bridge extension
@


1.6.42.1
log
@Release 5.3.3
@
text
@d61 2
a62 1
  php-cgi-i386-linux.ini # custom PHP ini file
d72 2
a73 1
  php.ini                 # custom PHP ini file
@


1.5
log
@Files update 3.2.2 to 4.0.1. Extracted from the src.tar.gz downloaded from sf.net, uploaded by Jost Boekemeier. Update to repository by Andre Felipe Machado.
@
text
@d3 1
a3 1
tries to call it via a /bin/sh wrapper (see php-fcgi.sh) or via a
d33 1
a33 1
PHP_FCGI_CHILDREN="20" \
d35 1
a35 1
php-fcgi.sh php-cgi-arch-os -c php-cgi-arch-os.ini -b 127.0.0.1:9667
d44 1
a44 1
set PHP_FCGI_CHILDREN "20" 
d46 1
a46 1
launcher.exe -a php-cgi -b 9667
d57 8
d66 9
a74 3
directory. Copy the wrapper "launcher.exe"[1] and the libraries it
needs (e.g. msvcr70.dll) into this directory and create a PHP .ini
file called php-cgi.ini.
d77 1
a77 1
and check if the application server has started 20 php-cgi-arch-os
a82 3

[1] See PHPIntKitForWindows.zip available from
http://www-128.ibm.com/alphaworks
@


1.4
log
@Release-3-1-7
@
text
@d31 1
d42 4
a45 3
X_JAVABRIDGE_OVERRIDE_HOSTS="/"
PHP_FCGI_CHILDREN="20" 
PHP_FCGI_MAX_REQUESTS="5000"
@


1.3
log
@Release-3-1-0
@
text
@d1 69
a69 16
If this directory does NOT contain a php CGI executable called
php-cgi-<architecture>-<os>[.exe|.sh], the following system default
FastCGI or CGI binary will used: /usr/bin/php-cgi or c:/php/php-cgi.exe.

If this directory DOES contain a php CGI executable, the bridge will
call it using the CGI interface.


Copy an executable PHP CGI binary into this directory. Or copy a PHP
CGI binary into this directory and create a wrapper
(recommended). Please see the php-cgi-x86-linux.sh and
php-cgi-i386-linux.sh for a template.

Note that FastCGI is currently only available on Unix/Linux; the
pre-compiled Windows php-cgi.exe doesn't support the necessary -b
option.
@


1.2
log
@Release-3-1-0
@
text
@d3 1
a3 1
FastCGI or CGI binary will used: /usr/bin/php-cgi or c:/php5/php-cgi.exe.
@


1.1
log
@Version-3.0.2
@
text
@d3 1
a3 2
FastCGI or CGI binary will used: /usr/bin/php-cgi, /usr/bin/php or
c:/php5/php-cgi.exe.
d14 3
a16 2


@


1.1.2.1
log
@Release-3-0-8-1
@
text
@d3 2
a4 1
FastCGI or CGI binary will used: /usr/bin/php-cgi or c:/php5/php-cgi.exe.
d15 2
a16 3
Note that FastCGI is currently only available on Unix/Linux; the
pre-compiled Windows php-cgi.exe doesn't support the necessary -b
option.
@

