head	1.7;
access;
symbols
	Release-7-1-1:1.7.0.6
	Root_Release-7-1-1:1.7
	Root_Release_7-0-1:1.7
	Release_7-0-1:1.7.0.4
	Release_7-0-0:1.7.0.2
	Root_Release_7-0-0:1.7
	Release-6-2-2:1.6.0.28
	Release-6-1-2-3:1.6
	Root_Release-6-1-2-3:1.6
	Release-6-1-2-2:1.6.0.26
	Root_Release-6-1-2-2:1.6
	debian_version_6_1_2_1-1:1.6
	upstream_version_6_1_2_1:1.6
	Release-6-1-2-1_new:1.6.0.24
	Root_Release-6-1-2-1_new:1.6
	Release-6-1-2-1:1.6.0.22
	Root_Release-6-1-2-1:1.6
	upstream_version_6_1_2:1.6
	debian_version_6_1_2-1:1.6
	Release-6-1-2:1.6.0.20
	Root_Release-6-1-2:1.6
	debian_version_6_1_1-2:1.6
	debian_version_6_1_1-1:1.6
	upstream_version_6_1_1:1.6
	Release-6-1-1:1.6.0.18
	Root_Release-6-1-1:1.6
	Release-6-0-4:1.6.0.16
	Root_Release-6-0-4:1.6
	Release-6-0-3_NEW:1.6.0.12
	Root_Release-6-0-3_NEW:1.6
	Release-6-0-3:1.6.0.14
	Root_Release-6-0-3:1.6
	Release-6-0-0:1.6.0.10
	Root_Release-6-0-0:1.6
	Release-5-5-4-1:1.6.0.8
	Root_Release-5-5-4-1:1.6
	Release-5-5-4:1.6.0.6
	Root_Release-5-5-4:1.6
	Release-5-5-3:1.6.0.4
	ROOT_Release-5-5-3:1.6
	Release-5-5-2:1.6.0.2
	Root_Release-5-5-2:1.6
	debian_version_5_5_1-1:1.6
	Release-5-5-1:1.5.0.30
	upstream_version_5_5_1:1.5
	ROOT_Release-5-5-1:1.5
	debian_version_5_5-1:1.5
	upstream_version_5_5:1.5
	ROOT_Release-5-5:1.5
	Release-5-5:1.5.0.32
	debian_version_5_4_4_2-3:1.5
	Release-5-4-4-2-1:1.5.0.26
	debian_version_5_4_4_2-2:1.5
	debian_version_5_4_4_2-1:1.5
	upstream_version_5_4_4_2:1.5
	debian_version_5_4_4_1-1:1.5
	upstream_version_5_4_4_1:1.5
	debian_version_5_4_4-1:1.5
	upstream_version_5_4_4:1.5
	Release-5-4-4:1.5.0.28
	Root_Release-5-4-4:1.5
	debian_version_5_4_3_2-1:1.5
	upstream_version_5_4_3_2:1.5
	Release_5-4-3-2:1.5.0.24
	Root_Release_5-4-3-2:1.5
	upstream_version_5_4_3_1:1.5
	debian_version_5_4_3_1-1:1.5
	Release-5-4-3:1.5.0.22
	Root_Release-5-4-3:1.5
	Root_Release-5-4-1:1.5
	Release-5-4-1:1.5.0.20
	Root_Release-5-4:1.5
	Release-5-4:1.5.0.18
	upstream_version_5_3_4:1.5
	debian_version_5_3_4-1:1.5
	ROOT_Release-5-3-4:1.5
	Release-5-3-4:1.5.0.16
	ROOT_Release-5-3-3:1.5
	Release-5-3-3:1.5.0.12
	debian_version_5_3_2_1_2-1:1.5
	upstream_version_5_3_2_1_2:1.5
	debian_version_5_3_2_1_1-1:1.5
	debian_version_5_3_2_1_1:1.5
	upstream_version_5_3_2_1_1:1.5
	Root_Release-5-3-2-1:1.5
	Release-5-3-2-1:1.5
	ROOT_RELEASE-5-3-2-1:1.5
	RELEASE-5-3-2-1:1.5.0.14
	Release-5-3-2:1.5.0.10
	Root_Release-5-3-2:1.5
	Root_Release-5-3-1:1.5
	Release-5-3-1:1.5.0.8
	Release-5-2-3-1:1.5.0.6
	Root_Release-5-2-3-1:1.5
	Release-5-2-2-4:1.5.0.4
	Root_Release-5-2-2-4:1.5
	Release-5-2-2-1:1.5.0.2
	Root_Release-5-2-2-1:1.5
	upstream_version_5_2_2:1.4
	debian_version_5_2_2-1:1.4
	Release-5-2-2:1.4.0.14
	ROOT_Release-5-2-2:1.4
	ROOT_Release-5-2-1:1.4
	Release-5-2-1:1.4.0.12
	Release-5-2-0:1.4.0.10
	ROOT_Release-5-2-0:1.4
	ROOT_Release-5-1-2:1.4
	Release-5-1-2:1.4.0.8
	Version-5-1-1:1.4.0.6
	ROOT_Version-5-1-1:1.4
	debian_version_5_1_0-1:1.4
	upstream_version_5_1_0:1.4
	ROOT_Release-5-1-0:1.4
	Release-5-1-0:1.4.0.4
	ROOT_Release-5-0-0:1.4
	Release-5-0-0:1.4.0.2
	Release-4-3-3:1.3.0.20
	ROOT_Release-4-3-3:1.3
	upstream_version_4_3_2:1.3
	debian_version_4_3_2-1:1.3
	ROOT_Release-4-3-2:1.3
	Release-4-3-2:1.3.0.18
	Release-4-3-1:1.3.0.16
	ROOT_Release-4-3-1:1.3
	debian_version_4_3_0-1:1.3
	upstream_version_4_3_0:1.3
	ROOT_Release-4-3-0:1.3
	Release-4-3-0:1.3.0.14
	debian_version_3_2_1b-2:1.3
	debian_version_4_2_2-1:1.3
	upstream_version_4_2_2:1.3
	debian_version_3_2_1b-1:1.3
	upstream_version_3_2_1b:1.3
	Release-4-1-2:1.3.0.12
	Release-4-0-8:1.3.0.10
	debian_version_4_0_8a-1:1.3
	upstream_version_4_0_8a:1.3
	jostb-debian-ubuntu-patch:1.3.0.8
	debian_version_4_0_8-1:1.3
	upstream_version_4_0_8:1.3
	debian_version_4_0_7-1:1.3
	upstream_version_4_0_7:1.3
	debian_version_4_0_6-1:1.3
	upstream_version_4_0_6:1.3
	debian_version_4_0_2-1:1.3
	upstream_version_4_0_2:1.3
	Release-4-0-2_Root:1.3
	Release-4-0-2:1.3.0.6
	upstream_version_4_0_1:1.3
	debian_version_4_0_1-2:1.3
	Release-3-2-1:1.3.0.4
	Release-3-1-8:1.3.0.2
	Release-3-0-8_root:1.1.2.2
	Release-3-0-8_Root:1.1
	Release-3-0-8:1.1.0.2;
locks; strict;
comment	@# @;


1.7
date	2017.02.07.00.11.17;	author jost_boekemeier;	state Exp;
branches;
next	1.6;

1.6
date	2009.08.28.15.45.49;	author jost_boekemeier;	state Exp;
branches;
next	1.5;

1.5
date	2008.09.20.15.00.58;	author jost_boekemeier;	state Exp;
branches;
next	1.4;

1.4
date	2008.01.06.20.59.20;	author jost_boekemeier;	state Exp;
branches;
next	1.3;

1.3
date	2006.08.08.17.20.45;	author jost2345;	state Exp;
branches;
next	1.2;

1.2
date	2006.07.16.20.29.26;	author jost2345;	state Exp;
branches;
next	1.1;

1.1
date	2006.04.12.17.57.39;	author jost2345;	state Exp;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2006.04.12.17.57.39;	author jost2345;	state dead;
branches;
next	1.1.2.2;

1.1.2.2
date	2006.04.23.19.26.41;	author jost2345;	state Exp;
branches;
next	;


desc
@@


1.7
log
@updated SEL
@
text
@policy_module(php-java-bridge,6.2.3)

########################################
#
# Declarations
#

type javabridge_t;
type javabridge_exec_t;
init_daemon_domain(javabridge_t,javabridge_exec_t)

domain_type(javabridge_t)
domain_entry_file(javabridge_t, javabridge_exec_t)

type javabridge_tmp_t;
files_tmp_file(javabridge_tmp_t)

type javabridge_var_run_t;
files_pid_file(javabridge_var_run_t)

########################################
#
# javabridge local policy
#
gen_require(`
	type httpd_log_t,sbin_t,inaddr_any_node_t,netif_t,lo_node_t,httpd_sys_content_t,port_t,var_log_t,devpts_t,httpd_t,java_exec_t,user_tmp_t;
')

####################
# Domain transitions
domain_auto_trans(httpd_t, javabridge_exec_t, javabridge_t)


#####################
# tmp 
allow javabridge_t javabridge_tmp_t:dir create_dir_perms;
allow javabridge_t javabridge_tmp_t:dir { write search rmdir read remove_name add_name };
allow javabridge_t javabridge_tmp_t:file { read write unlink };
allow javabridge_t javabridge_tmp_t:file create_file_perms;
allow javabridge_t javabridge_tmp_t:file rename;
allow javabridge_t tmpfs_t:dir search;
files_tmp_filetrans(javabridge_t,javabridge_tmp_t,{ file dir })


###########
allow javabridge_t devpts_t:chr_file { read write };
allow javabridge_t javabridge_exec_t:file execute_no_trans;
allow javabridge_t self:process { execmem signal };
allow javabridge_t self:unix_stream_socket { accept listen };

#########
# Connect from httpd.
allow httpd_t javabridge_exec_t:file getattr;
allow httpd_t javabridge_t:unix_stream_socket connectto;

# Connect from httpd using tcp sockets
allow javabridge_t self:tcp_socket { accept bind connect create getattr listen read setopt write shutdown };
allow javabridge_t port_t:tcp_socket { name_bind name_connect recv_msg send_msg };

corenet_tcp_sendrecv_generic_if(javabridge_t)
#corenet_non_ipsec_sendrecv(javabridge_t)
corenet_all_recvfrom_unlabeled(javabridge_t) 
allow javabridge_t lo_node_t:node { tcp_recv tcp_send };
allow javabridge_t lo_node_t:tcp_socket node_bind;

dontaudit javabridge_t inaddr_any_node_t:tcp_socket node_bind;
dontaudit javabridge_t sbin_t:dir search;
#########

##################################
# /usr/bin/java
corecmd_exec_bin(javabridge_t);
# /usr/bin/gij
allow javabridge_t java_exec_t:file { execute execute_no_trans read };

kernel_read_network_state(javabridge_t)
kernel_read_system_state(javabridge_t)
kernel_read_all_sysctls(javabridge_t)
kernel_search_vm_sysctl(javabridge_t)

# compatibility with fedora 10, fedora 11
#userdom_write_user_tmp_sockets(javabridge_t)
files_search_tmp(javabridge_t)
write_sock_files_pattern(javabridge_t, user_tmp_t, user_tmp_t)


dev_read_sound(javabridge_t)
dev_write_sound(javabridge_t)
dev_read_urand(javabridge_t)
dev_read_rand(javabridge_t)

files_read_etc_files(javabridge_t)
files_read_usr_files(javabridge_t)
files_search_var_lib(javabridge_t)
files_read_etc_runtime_files(javabridge_t)
# Read global fonts and font config
files_read_etc_files(javabridge_t)

fs_getattr_xattr_fs(javabridge_t)
fs_dontaudit_rw_tmpfs_files(javabridge_t)

libs_use_ld_so(javabridge_t)
libs_use_shared_libs(javabridge_t)

miscfiles_read_localization(javabridge_t)
# Read global fonts and font config
miscfiles_read_fonts(javabridge_t)

###################################################
# Read /var/www
allow javabridge_t httpd_sys_content_t:dir list_dir_perms;
allow javabridge_t httpd_sys_content_t:file read_file_perms;
allow javabridge_t httpd_sys_content_t:lnk_file {getattr read};

sysnet_read_config(javabridge_t)

###################################################
# Running the back-end as a sub-component of apache
apache_use_fds(javabridge_t)
apache_sigchld(javabridge_t)
allow javabridge_t httpd_t:fifo_file rw_file_perms;
allow httpd_t javabridge_t:process { sigkill signal };
# append to apache log
allow javabridge_t httpd_log_t:file append;
allow javabridge_t self:fifo_file { getattr read write };
allow javabridge_t self:process { getsched sigkill };

####################################################
# Insane settings needed for sun java 1.5.  Comment this out, if you
# can.
allow javabridge_t javabridge_tmp_t:file { execute };
allow javabridge_t usr_t:file { execute };
allow javabridge_t locale_t:file { execute };
allow javabridge_t random_device_t:chr_file { append };
@


1.6
log
@Fedora 11 SEL updates
@
text
@d1 1
a1 1
policy_module(javabridge,5.5.1)
@


1.5
log
@Release-5-2-2-1
@
text
@d1 1
a1 1
policy_module(javabridge,5.2.2.1)
d26 1
a26 1
	type httpd_log_t,sbin_t,inaddr_any_node_t,netif_t,lo_node_t,httpd_sys_content_t,port_t,var_log_t,devpts_t,httpd_t,java_exec_t;
d80 6
a85 1
userdom_write_user_tmp_sockets(javabridge,javabridge_t)
d113 1
a113 1
allow javabridge_t httpd_sys_content_t:lnk_file read_file_perms;
@


1.4
log
@Release-5-0-0
@
text
@d1 1
a1 1
policy_module(javabridge,4.3.3)
d106 3
a108 3
allow javabridge_t httpd_sys_content_t:dir r_dir_perms;
allow javabridge_t httpd_sys_content_t:file r_file_perms;
allow javabridge_t httpd_sys_content_t:lnk_file r_file_perms;
@


1.3
log
@Release-3-1-7
@
text
@d1 1
a1 1
policy_module(javabridge,3.1.7)
d37 2
d40 2
d61 2
a62 1
corenet_non_ipsec_sendrecv(javabridge_t)
@


1.2
log
@Release-3-1-6
@
text
@d1 1
a1 1
policy_module(javabridge,2.0.0)
a14 3
#type javabridge_log_t;
#logging_log_file(javabridge_log_t)

d26 1
a26 1
	type sbin_t,inaddr_any_node_t,netif_t,lo_node_t,httpd_sys_content_t,port_t,var_log_t,devpts_t,httpd_t,java_exec_t;
d28 12
a39 2
allow javabridge_t var_log_t:file ra_file_perms;
allow javabridge_t javabridge_tmp_t:file manage_file_perms;
d65 1
a65 1
#########
d99 1
a105 1
#########
d107 12
@


1.1
log
@Release-3.0.8
@
text
@d29 1
a29 1
	type var_log_t,devpts_t,httpd_t,java_exec_t;
d40 2
d44 14
d92 5
@


1.1.2.1
log
@file php-java-bridge.te was added on branch Release-3-0-8 on 2006-04-23 19:26:41 +0000
@
text
@d1 84
@


1.1.2.2
log
@Release-3-0-8-1
@
text
@a0 84
policy_module(javabridge,2.0.0)

########################################
#
# Declarations
#

type javabridge_t;
type javabridge_exec_t;
init_daemon_domain(javabridge_t,javabridge_exec_t)

domain_type(javabridge_t)
domain_entry_file(javabridge_t, javabridge_exec_t)

#type javabridge_log_t;
#logging_log_file(javabridge_log_t)

type javabridge_tmp_t;
files_tmp_file(javabridge_tmp_t)

type javabridge_var_run_t;
files_pid_file(javabridge_var_run_t)

########################################
#
# javabridge local policy
#
gen_require(`
	type var_log_t,devpts_t,httpd_t,java_exec_t;
')
allow javabridge_t var_log_t:file ra_file_perms;
allow javabridge_t javabridge_tmp_t:file manage_file_perms;

###########
allow javabridge_t devpts_t:chr_file { read write };
allow javabridge_t javabridge_exec_t:file execute_no_trans;
allow javabridge_t self:process { execmem signal };
allow javabridge_t self:unix_stream_socket { accept listen };

allow httpd_t javabridge_exec_t:file getattr;
allow httpd_t javabridge_t:unix_stream_socket connectto;
#########
# /usr/bin/java
corecmd_exec_bin(javabridge_t);
# /usr/bin/gij
allow javabridge_t java_exec_t:file { execute execute_no_trans read };

kernel_read_network_state(javabridge_t)
kernel_read_system_state(javabridge_t)
kernel_read_all_sysctls(javabridge_t)
kernel_search_vm_sysctl(javabridge_t)
userdom_write_user_tmp_sockets(javabridge,javabridge_t)

dev_read_sound(javabridge_t)
dev_write_sound(javabridge_t)
dev_read_urand(javabridge_t)
dev_read_rand(javabridge_t)

files_read_etc_files(javabridge_t)
files_read_usr_files(javabridge_t)
files_search_var_lib(javabridge_t)
files_read_etc_runtime_files(javabridge_t)
# Read global fonts and font config
files_read_etc_files(javabridge_t)

fs_getattr_xattr_fs(javabridge_t)
fs_dontaudit_rw_tmpfs_files(javabridge_t)

libs_use_ld_so(javabridge_t)
libs_use_shared_libs(javabridge_t)

miscfiles_read_localization(javabridge_t)
# Read global fonts and font config
miscfiles_read_fonts(javabridge_t)

sysnet_read_config(javabridge_t)
#########

# Insane settings needed for sun java 1.5.  Comment this out, if you
# can.
allow javabridge_t javabridge_tmp_t:file { execute };
allow javabridge_t usr_t:file { execute };
allow javabridge_t locale_t:file { execute };
allow javabridge_t random_device_t:chr_file { append };
@


