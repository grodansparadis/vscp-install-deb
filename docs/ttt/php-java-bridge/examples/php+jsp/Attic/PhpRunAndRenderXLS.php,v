head	1.2;
access;
symbols
	Release-7-1-1:1.1.0.8
	Root_Release-7-1-1:1.1
	Root_Release_7-0-1:1.1
	Release_7-0-1:1.1.0.6
	Release_7-0-0:1.1.0.4
	Root_Release_7-0-0:1.1
	Release-6-2-2:1.1.0.2;
locks; strict;
comment	@# @;


1.2
date	2017.04.14.13.01.09;	author jost_boekemeier;	state dead;
branches;
next	1.1;

1.1
date	2010.08.18.18.49.38;	author gromwe;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Removed JavaProxy.php
@
text
@<?php
header("Content-type: application/vnd.ms-excel");
header("Content-Disposition: inline; filename=downloadedmsxls.xls");

define ("JAVA_HOSTS", "127.0.0.1:8080");
define ("JAVA_SERVLET", "/JavaBridge/JavaBridge.phpjavabridge");

require_once("java/Java.inc");

session_start(); 

$here = getcwd();

$ctx = java_context()->getServletContext();
$birtReportEngine =        java("org.eclipse.birt.php.birtengine.BirtEngine")->getBirtEngine($ctx);
java_context()->onShutdown(java("org.eclipse.birt.php.birtengine.BirtEngine")->getShutdownHook());


try{


$report = $birtReportEngine->openReportDesign("${here}/TopNPercent.rptdesign");
$task = $birtReportEngine->createRunAndRenderTask($report);
$taskOptions = new java("org.eclipse.birt.report.engine.api.RenderOption");
$outputStream = new java("java.io.ByteArrayOutputStream");
$taskOptions->setOutputStream($outputStream);
$taskOptions->setOutputFormat("xls");

$task->setRenderOption( $taskOptions );
$task->run();
$task->close();

} catch (JavaException $e) {
	echo $e; //"Error Calling BIRT";
	
}
//echo "test";
//echo $outputStream->toString().trim();
echo java_values($outputStream->toByteArray());



?>@


1.1
log
@birt 2.6 update
@
text
@@

